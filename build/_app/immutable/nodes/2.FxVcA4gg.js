var Y=Object.defineProperty;var j=(a,e,t)=>e in a?Y(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var L=(a,e,t)=>j(a,typeof e!="symbol"?e+"":e,t);import{a as G,f as V}from"../chunks/DMzwejHP.js";import{o as X,a as J}from"../chunks/SIfsRWbL.js";import{h as k,X as Q,aq as Z,ar as aa,as as ea,at as ta,au as ra,av as sa,v as na,V as oa,c as b,aw as la,D as ia,ax as I,ay as ca,F as ua,A as o,G as da,K as _,az as f,I as u,aa as va,J as d}from"../chunks/CDhNwEdX.js";import{d as _a,a as R,s as S}from"../chunks/BZXOAoc_.js";import{i as fa}from"../chunks/BHwURogT.js";function ha(a,e,t){var r=a==null?"":""+a;return r===""?null:r}function K(a,e,t,r,s,n){var c=a.__className;if(k||c!==t||c===void 0){var i=ha(t);(!k||i!==a.getAttribute("class"))&&(i==null?a.removeAttribute("class"):a.className=i),a.__className=t}return n}const ba=Symbol("is custom element"),ya=Symbol("is html"),ma=ta?"link":"LINK";function ka(a){if(k){var e=!1,t=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var r=a.value;M(a,"value",null),a.value=r}if(a.hasAttribute("checked")){var s=a.checked;M(a,"checked",null),a.checked=s}}};a.__on_r=t,Q(t),Z()}}function M(a,e,t,r){var s=pa(a);k&&(s[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName===ma)||s[e]!==(s[e]=t)&&(e==="loading"&&(a[aa]=t),a.removeAttribute(e))}function pa(a){return a.__attributes??(a.__attributes={[ba]:a.nodeName.includes("-"),[ya]:a.namespaceURI===ea})}function Ea(a,e,t=e){var r=new WeakSet;ra(a,"input",async s=>{var n=s?a.defaultValue:a.value;if(n=x(a)?O(n):n,t(n),b!==null&&r.add(b),await sa(),n!==(n=e())){var c=a.selectionStart,i=a.selectionEnd,p=a.value.length;if(a.value=n??"",i!==null){var v=a.value.length;c===i&&i===p&&v>p?(a.selectionStart=v,a.selectionEnd=v):(a.selectionStart=c,a.selectionEnd=Math.min(i,v))}}}),(k&&a.defaultValue!==a.value||na(e)==null&&a.value)&&(t(x(a)?O(a.value):a.value),b!==null&&r.add(b)),oa(()=>{var s=e();if(a===document.activeElement){var n=la??b;if(r.has(n))return}x(a)&&s===O(a.value)||a.type==="date"&&!s&&!a.value||s!==a.value&&(a.value=s??"")})}function x(a){var e=a.type;return e==="number"||e==="range"}function O(a){return a===""?null:+a}function Ia(a,e=!1){return window.__TAURI_INTERNALS__.transformCallback(a,e)}async function m(a,e={},t){return window.__TAURI_INTERNALS__.invoke(a,e,t)}var H;(function(a){a.WINDOW_RESIZED="tauri://resize",a.WINDOW_MOVED="tauri://move",a.WINDOW_CLOSE_REQUESTED="tauri://close-requested",a.WINDOW_DESTROYED="tauri://destroyed",a.WINDOW_FOCUS="tauri://focus",a.WINDOW_BLUR="tauri://blur",a.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",a.WINDOW_THEME_CHANGED="tauri://theme-changed",a.WINDOW_CREATED="tauri://window-created",a.WEBVIEW_CREATED="tauri://webview-created",a.DRAG_ENTER="tauri://drag-enter",a.DRAG_OVER="tauri://drag-over",a.DRAG_DROP="tauri://drag-drop",a.DRAG_LEAVE="tauri://drag-leave"})(H||(H={}));async function Aa(a,e){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(a,e),await m("plugin:event|unlisten",{event:a,eventId:e})}async function ga(a,e,t){var r;const s=(r=void 0)!==null&&r!==void 0?r:{kind:"Any"};return m("plugin:event|listen",{event:a,target:s,handler:Ia(e)}).then(n=>async()=>Aa(a,n))}class wa{constructor(){L(this,"heartbeatInterval",null);L(this,"status",{pulse:"FAIL",latency:0})}async ptyWrite(e){await m("pty_write",{data:e})}async setLock(e){await m("set_bridge_lock",{locked:e})}async listenPty(e){return await ga("pty-data",t=>{e(t.payload)})}startHeartbeat(e){this.heartbeatInterval||(this.heartbeatInterval=window.setInterval(async()=>{const t=Date.now();try{await m("heartbeat")==="PULSE_OK"&&(this.status={pulse:"OK",latency:Date.now()-t})}catch{this.status={pulse:"FAIL",latency:-1}}e(this.status)},100))}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}}const y=new wa;var Na=V('<div class="absolute inset-0 bg-kora-rust bg-opacity-10 backdrop-blur-sm flex items-center justify-center z-50"><div class="bg-kora-surface p-6 rounded-2xl border-2 border-kora-rust shadow-2xl text-center"><h2 class="text-kora-rust font-bold mb-2">BRIDGE LOCKED</h2> <p class="text-xs text-gray-400">Awaiting user authorization for Ring 0...</p></div></div>'),Da=V('<main class="h-screen w-screen flex flex-col p-6 space-y-4"><header class="kora-header"><div class="flex items-center space-x-3"><div></div> <h1 class="text-kora-gold font-bold tracking-widest text-sm">KORA OS | NATIVE BRIDGE</h1></div> <div class="text-xs font-mono text-gray-500"> </div></header> <section class="kora-terminal"><!> <div class="flex-1 overflow-y-auto whitespace-pre-wrap break-all scrollbar-hide"> </div> <div class="mt-4 flex items-center border-t border-kora-border pt-3"><span class="text-kora-gold mr-2">‚ùØ</span> <input placeholder="Enter command..." class="kora-input"/></div></section> <footer class="flex space-x-4"><button> </button> <button class="kora-btn kora-btn-primary opacity-50 hover:opacity-100">CLEAR BUFFER</button></footer></main>');function Ca(a,e){ia(e,!0);let t=I(""),r=I(""),s=I(ca({pulse:"FAIL",latency:0})),n=I(!1),c=null;X(async()=>{y.startHeartbeat(l=>{f(s,l,!0)}),c=await y.listenPty(l=>{f(t,o(t)+l);const E=o(t).split(`
`);E.length>50&&f(t,E.slice(-50).join(`
`),!0)})}),J(()=>{y.stopHeartbeat(),c&&c()});async function i(l){l.key==="Enter"&&(await y.ptyWrite(o(r)+`
`),f(r,""))}async function p(){f(n,!o(n)),await y.setLock(o(n))}var v=Da(),A=u(v),g=u(A),B=u(g);va(2),d(g);var W=_(g,2),F=u(W);d(W),d(A);var w=_(A,2),C=u(w);{var P=l=>{var E=Na();G(l,E)};fa(C,l=>{o(n)&&l(P)})}var N=_(C,2),z=u(N,!0);d(N);var T=_(N,2),D=_(u(T),2);ka(D),d(T),d(w);var U=_(w,2),h=u(U),$=u(h,!0);d(h);var q=_(h,2);d(U),d(v),ua(()=>{K(B,1,`w-3 h-3 rounded-full ${o(s).pulse==="OK"?"bg-green-500 animate-pulse":"bg-red-500"}`),S(F,`LATENCY: ${o(s).latency??""}ms | STATUS: ${o(s).pulse??""}`),S(z,o(t)),K(h,1,`kora-btn ${o(n)?"kora-btn-danger":"kora-btn-primary"}`),S($,o(n)?"UNLOCK BRIDGE":"SIMULATE LOCK")}),R("keydown",D,i),Ea(D,()=>o(r),l=>f(r,l)),R("click",h,p),R("click",q,()=>{f(t,"")}),G(a,v),da()}_a(["keydown","click"]);export{Ca as component};
